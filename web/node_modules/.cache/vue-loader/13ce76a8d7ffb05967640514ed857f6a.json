{"remainingRequest":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/src/views/Catalogo.vue?vue&type=style&index=0&id=1f46eaa0&scoped=true&lang=css&","dependencies":[{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/src/views/Catalogo.vue","mtime":1626293412580},{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKYi1pbWd7CiAgICB3aWR0aDo2MHB4OwogICAgaGVpZ2h0OjYwcHg7Cn0KLmJkLXNpZGViYXIgewogICAgbWF4LWhlaWdodDogMzByZW07CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTdhMmI4OwogICAgY29sb3I6ICNmN2Y3Zjc7Cn0gICAgCg=="},{"version":3,"sources":["Catalogo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Catalogo.vue","sourceRoot":"src/views","sourcesContent":["<template>\n\n<b-container fluid=\"1\">\n    <div id=\"main\" class=\"row flex-xl-nowrap2 mt-5 mb-2 pl-2 pr-2\">\n        <div class=\"bd-sidebar border-bottom-0 col-md-3 col-xl-2 col-12\">\n            <form class=\"bd-search d-flex align-items-center\">\n                <span class=\"algolia-autocomplete\">\n                    <h5 class=\"mt-3\" text-variant=\"light\">Búsqueda</h5>\n                    <!-- select filtro busqueda producto -->\n                    <b-form-input placeholder=\"Búsqueda Título\" class=\"mt-3\" type=\"search\" v-model=\"texto1\" :state=\"null\"></b-form-input>\n                    <b-form-input placeholder=\"Búsqueda Autor\" class=\"mt-3\" type=\"search\" v-model=\"texto2\" :state=\"null\"></b-form-input>\n                    <b-button class=\"mt-3 float-right\" variant='success' size=\"sm\" @click=\"filtroBuscarProducto()\">Buscar</b-button>\n                </span>\n            </form>\n            <nav class=\"bd-links d-none d-md-block\">\n                <ul class=\"nav bd-sidenav\">\n                    <li class=\"nav-item mt-5\"> Filtros de búsqueda\n                        <!-- select filtro tipo producto -->\n                        <b-form-select class=\"mt-3\" v-model=\"tipoproducto\" :options=\"tipoproductos\" value-field=\"id_tipo_prod\" text-field=\"desc_t_prod\" size=\"sm\" @change=\"cargarFiltroTipoProducto()\">\n                            <template #first>\n                                <b-form-select-option :value=\"null\" disabled>Tipo Producto</b-form-select-option>\n                            </template>\n                        </b-form-select>\n                            \n                        <!-- select filtro categoria producto -->\n                        <b-form-select class=\"mt-3\" v-model=\"categoria\" :options=\"categorias\" value-field=\"id_categoria\" text-field=\"desc_cat\" size=\"sm\" @change=\"cargarFiltroCategoria()\">\n                            <template #first>\n                                <b-form-select-option :value=\"null\" disabled>Categor&iacute;a Producto</b-form-select-option>\n                            </template>\n                        </b-form-select>\n                        <!-- select filtro lugar prestamo -->\n                        <b-form-select class=\"mt-3\" v-model=\"item2\" :options=\"lugarPrestamo\" value-field=\"text\" text-field=\"text\" size=\"sm\" @change=\"cargarFiltroLugar()\">\n                            <template #first>\n                                <b-form-select-option :value=\"null\" disabled>Lugar Pr&eacute;stamo</b-form-select-option>\n                            </template>\n                        </b-form-select>\n                        <!-- Borrar filtros -->\n                        <b-button id=\"borrarfiltro\" class=\"mt-5\" block variant=\"dark\" @click=\"borrarFiltros()\">Borrar Filtros</b-button>\n                    </li>                    \n                </ul>\n            </nav>\n        </div>\n        <div class=\"bd-content col-md-10 col-xl-10 col-12 pb-md-3 pl-md-5\">\n            \n            <b-row class=\" mr-5\">\n                <b-col>\n                    <b-button class=\"float-right\" variant='info' small v-show=\"showBtnIniciar\" @click='iniciar()'>Iniciar Sesión</b-button>\n                    <b-button class=\"float-right mr-3\" variant='outline-info' small v-show=\"showBtnRegistrar\" v-b-modal.modalRegistrarLector>Registrarse</b-button>\n                </b-col>\n            </b-row>\n            <b-row class=\"mt-4\">\n                <b-col>\n                    <b-dropdown size=\"lg\" text=\"Dropdown Button\" variant=\"info\" v-show=\"btnSesion\"\n                    toggle-class=\"text-decoration-none\">\n                        <template #button-content>\n                            <b-avatar variant=\"light\" :src=\"foto\" size=\"3rem\"></b-avatar><span class=\"ml-2\">{{rut}}</span>\n                        </template>\n                        <b-dropdown-item variant=\"primary\" @click=\"cerrarSesion\">Cerrar Sesión</b-dropdown-item>\n                    </b-dropdown>\n                </b-col>\n                <b-col align=\"right\">\n                    <b-dropdown name=\"dropdown1\" id=\"dropdown1\" v-show=\"showDropdown\"\n                    :text=\"'Lista de deseos ('+tmp.length+')'\" class=\"m-md-2\" variant=\"warning\">                        \n                        <b-dropdown-item v-b-modal.modalDetalleReserva>Ir a reservar</b-dropdown-item>                        \n                    </b-dropdown>\n                </b-col>\n            </b-row>\n            <!-- BCARD PRODUCTO -->\n            <b-row class=\"mt-3\">\n                <b-card-group columns>            \n                    <b-card\n                        :sub-title=\"item.desc_prod\"\n                        :img-src=\"item.foto_producto\"\n                        :img-alt=\"item.titulo\"\n                        img-top\n                        img-height=\"350\"\n                        style=\"max-width: 25rem;\"            \n                        class=\"mb-4\"\n                        v-for=\"item in productos\" :key=\"item.id_producto\" >\n                        <template #header>\n\t\t\t\t\t\t\t<b-row>\n\t\t\t\t\t\t\t\t<b-col><h5>{{item.titulo}}</h5></b-col>\n\t\t\t\t\t\t\t</b-row>\n\t\t\t\t\t\t\t<template v-if=\"item.cantidad==0\">\n\t\t\t\t\t\t\t\t<b-row>\n\t\t\t\t\t\t\t\t\t<b-col><small class=\"text-danger\"><span >Sin Stock</span></small></b-col>\n\t\t\t\t\t\t\t\t</b-row>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<b-row>\n\t\t\t\t\t\t\t\t\t<b-col><small class=\"text-muted\">Disponible:</small><small class=\"text-muted ml-1\">{{item.cantidad}}</small></b-col>\n\t\t\t\t\t\t\t\t</b-row>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\n                        </template>\n\n                        <b-row class=\"mt-2\">\n                            <b-col><b-link v-b-modal.modalDetalleProducto @click=\"buscarProducto(item.id_producto)\" href=\"\">Ver detalle >></b-link></b-col>                                \n                        </b-row>                        \n\n                        <template #footer>\n                            <template v-if=\"item.cantidad==0\">\n\n                                <b-row>\n                                    <b-col align=\"right\">\n                                        <b-row>\n\t\t\t\t\t\t\t\t\t\t\t<b-col cols=\"6.5\" class=\"pl-3\">\n                                                <b-form-datepicker disabled placeholder=\"Fecha reserva\" size=\"sm\" v-model=\"value[item.id_producto]\"\n\t\t\t\t\t\t\t\t\t\t\t    :min=\"min\" :max=\"max\" locale=\"\" :state=\"null\"\n\t\t\t\t\t\t\t\t\t\t\t    :date-format-options=\"{ year: 'numeric', month: 'numeric', day: 'numeric' }\"></b-form-datepicker>\n                                            </b-col>\n\t\t\t\t\t\t\t\t\t\t\t<b-col>\n                                                <b-button disabled class=\"float-right\" variant='primary' size=\"sm\"\n                                                @click=\"anadirProducto(item.id_producto,value[item.id_producto])\">\n                                                A&ntilde;adir a la lista</b-button>\n                                            </b-col>\n\t\t\t\t\t\t\t\t\t\t</b-row>\n                                    </b-col>\n                                </b-row>\n\n                            </template>\n                            <template v-else>\n\n                                <b-row>\n                                    <b-col align=\"right\">\n\t\t\t\t\t\t\t\t\t\t<b-row>\n\t\t\t\t\t\t\t\t\t\t\t<b-col cols=\"6.5\" class=\"pl-3\">\n                                                <b-form-datepicker placeholder=\"Fecha reserva\" size=\"sm\" v-model=\"value[item.id_producto]\" \n\t\t\t\t\t\t\t\t\t\t\t    :min=\"min\" :max=\"max\" locale=\"\" :state=\"null\" :disabled=\"btnAnadirLista.estadoFecha[item.id_producto] ? true:false\"\n\t\t\t\t\t\t\t\t\t\t\t    :date-format-options=\"{ year: 'numeric', month: 'numeric', day: 'numeric',  }\"></b-form-datepicker>\n                                            </b-col>\n\t\t\t\t\t\t\t\t\t\t\t<b-col>\n                                                <b-button class=\"float-right\" variant='primary' size=\"sm\" :disabled=\"btnAnadirLista.estado[item.id_producto] ? true:false\"\n                                                @click=\"anadirProducto(item.id_producto,value[item.id_producto])\">\n                                                {{btnAnadirLista.texto[item.id_producto] ? ' Añadido':'Añadir a la lista' }}</b-button>\n                                            </b-col>\n\t\t\t\t\t\t\t\t\t\t</b-row>\n                                    </b-col>\n                                </b-row>\n\n                            </template>\n\n                        </template>\n                    </b-card>            \n                </b-card-group>\n            </b-row>\n\n            <!-- Modal Detalle Producto -->\n            <div id=\"divDetalle\" name=\"divDetalle\">\n                <template>\n                    <b-modal id=\"modalDetalleProducto\" name=\"modalDetalleProducto\" size=\"lg\" no-close-on-esc scrollable centered :title='item.titulo' \n                        v-model='modalShow1' header-bg-variant='primary' header-text-variant='light' no-close-on-backdrop hide-header-close\n                        footer-bg-variant=\"light\">\n                        <b-container fluid>\n                                <b-row>\n                                    <b-col cols=\"6\">\n                                        <b-img fluid style=\"height:400px\" :src=\"producto.foto_producto\"></b-img>\n                                    </b-col>\n                                    \n                                    <b-col cols=\"4\">\n                                        <b-row>\n                                            <b-col>\n                                                <h1>{{producto.titulo}}</h1>\n                                                <h4>{{producto.desc_prod}}</h4>\n                                                <p>por: {{producto.autor}}</p>\n                                            </b-col>                                        \n                                        </b-row>\n                                        <b-row class=\"mt-3\">\n                                            <b-col align=\"center\">\n                                                <b-card>\n                                                    <b-row><small>Id: {{producto.id_producto}}</small></b-row>                                                \n                                                    <b-row><small>Editorial: {{producto.editorial}}</small></b-row>\n                                                    <b-row><small>Edición: {{producto.edicion}}</small></b-row>\n                                                    <b-row><small>Año edición: {{producto.anno_edic}}</small></b-row>\n                                                    <b-row><small>Duración: {{producto.duracion}}</small></b-row>\n                                                    <b-row><small>Tiempo de préstamo (HRS): {{producto.tiempo_prest}}</small></b-row>\n                                                    <b-row><small>Préstamo a: {{producto.lugar_prest}}</small></b-row>                                                \n                                                    <b-row><small>Id Categoría: {{producto.id_categoria}}</small></b-row>\n                                                    <b-row><small>Ubicación: {{producto.id_ubicacion}}</small></b-row>\n                                                </b-card>\n                                            </b-col>                                        \n                                        </b-row>                                                                        \n                                    </b-col>\n                                </b-row>\n                                <b-row>\n                                    <b-col></b-col>\n                                </b-row>\n                        </b-container>\n                        <template #modal-footer>\n                            <div class=\"w-100\">\n                                <span class=\"float-left text-muted\">Cantidad Disponible: {{producto.cantidad}}</span>\n\n                                <template v-if=\"producto.lugar_prest=='Sala' || producto.lugar_prest=='Sala y Domicilio'\">\n                                    <span class=\"text-info ml-5\">Pr&eacute;stamos en sala:</span><span class=\"text-info ml-1\">{{cantidadProductosSala}}</span>\n                                </template>\n                                \n                                <b-button class=\"float-right\" variant='primary' small @click='modalShow1 = !modalShow1'>Cerrar</b-button>\n                            </div>                                                \n                        </template>\n                    </b-modal>\n                </template>\n            </div>\n\n            <!-- Modal Detalle Reserva -->\n            <div id=\"divDetalle\" name=\"divDetalle\">\n                <template>\n                    <b-modal id=\"modalDetalleReserva\" name=\"modalDetalleReserva\" size=\"lg\" no-close-on-esc scrollable centered title='Lista de deseos' \n                        v-model='modalShow2' header-bg-variant='primary' header-text-variant='light' no-close-on-backdrop hide-header-close\n                        footer-bg-variant=\"light\">\n                        <b-container fluid>\n                            <div v-if=\"detalleReserva.length>0\">\n                                <b-row class=\"mt-5\" v-for=\"item1 in detalleReserva\" :key=\"item1.id_producto\">\n                                    <b-col align=\"right\" cols=\"2\">\n                                        <b-button size=\"sm\" variant=\"danger\" @click=\"quitarListaDeseo(item1.id_producto)\">X</b-button>\n                                    </b-col>\n                                    \n                                    <b-card no-body class=\"overflow-hidden\" style=\"width: 600px;\" bg-variant=\"light\">                                                                                              \n                                        <b-row>\n                                            <b-col cols=\"4\">\n                                                <b-card-img :src=\"item1.foto_producto\" :alt=\"item1.titulo\" height=\"200\" ></b-card-img>\n                                            </b-col>\n                                            <b-col cols=\"8\">\n                                                <b-row>\n                                                    <b-col>\n                                                        <b-card-body :title=\"item1.titulo\">\n                                                            <b-card-text>{{item1.desc_prod}}</b-card-text>\n                                                            <b-card-text> <b-link>Cantidad: 1</b-link></b-card-text>\n                                                        </b-card-body>\n                                                    </b-col>                                            \n                                                </b-row>                                        \n                                            </b-col>\n                                        </b-row>                                                                                       \n                                    </b-card>                            \n                                </b-row>\n                            </div>\n                            <div v-else>\n                                <b-row>\n                                    <b-col align=\"center\">\n                                        <h4>Lista Vacía</h4>\n                                        <p>Vuelva al Catálogo y seleccione según su interés.</p>\n                                    </b-col>\n                                </b-row>                            \n                            </div>\n                            \n                        </b-container>\n                        <template #modal-footer>\n                            <div class=\"w-100\">\n                                <b-row>\n                                    <b-col align=\"right\">\n                                        <b-button variant='secondary' style=\"width: 4rem;\" size=\"sm\" @click='modalShow2 = !modalShow2'>Cerrar</b-button>\n                                        <b-button class=\"ml-3\" style=\"width: 8rem;\" variant='primary' size=\"sm\" @click=\"guardarReserva()\">Reservar</b-button>\n                                    </b-col>                                        \n                                </b-row>                                    \n                            </div>                                                \n                        </template>\n                    </b-modal>\n                </template>\n            </div>\n\n            <!-- Modal Registrar Lector -->\n            <div id=\"divRegistrarLector\" name=\"divRegistrarLector\">\n                <template>\n                    <b-modal id=\"modalRegistrarLector\" name=\"modalRegistrarLector\" size=\"lg\" no-close-on-esc scrollable centered title='Registrar nueva cuenta' \n                        v-model='modalShow3' header-bg-variant='primary' header-text-variant='light' no-close-on-backdrop hide-header-close\n                        footer-bg-variant=\"light\">\n                        <b-container fluid=\"\">\n                            <b-row>\n                                <b-col cols=\"1\"></b-col>\n                                <b-col><span>Rut:</span></b-col><b-col cols=\"7\"><b-form-input class=\"ml-4\" placeholder=\"ej: 12.345.678-9\" type=\"text\" v-model=\"lector.rut_lector\" :state=\"formatearRutLector\" size=\"sm\" autofocus></b-form-input></b-col>\n                                <b-col></b-col>\n                            </b-row>\n                            <b-row class=\"mt-3\">\n                                <b-col cols=\"1\"></b-col>\n                                <b-col><span>Nombre:</span></b-col><b-col cols=\"7\"><b-form-input class=\"ml-4\" placeholder=\"ej: Pedro\" type=\"text\" v-model=\"lector.nomb_lec\" :state=\"null\" size=\"sm\"></b-form-input></b-col>\n                                <b-col></b-col>\n                            </b-row>\n                            <b-row class=\"mt-3\">\n                                <b-col cols=\"1\"></b-col>\n                                <b-col><span>Apellido:</span></b-col><b-col cols=\"7\"><b-form-input class=\"ml-4\" placeholder=\"ej: Arriagada\" type=\"text\" v-model=\"lector.ape_lec\" :state=\"null\" size=\"sm\"></b-form-input></b-col>\n                                <b-col></b-col>\n                            </b-row>\n                            <b-row class=\"mt-3\">\n                                <b-col cols=\"1\"></b-col>\n                                <b-col><span>Direcci&oacute;n:</span></b-col><b-col cols=\"7\"><b-form-input class=\"ml-4\" placeholder=\"ej: Calle nueva 1390\" type=\"text\" v-model=\"lector.direccion\" :state=\"null\" size=\"sm\"></b-form-input></b-col>\n                                <b-col></b-col>\n                            </b-row>\n                            <b-row class=\"mt-3\">\n                                <b-col cols=\"1\"></b-col>\n                                <b-col><span>Email:</span></b-col><b-col cols=\"7\"><b-form-input class=\"ml-4\" placeholder=\"ej: pedroarriagada@mail.com\" type=\"email\" v-model=\"lector.correo_lec\" :state=\"null\" size=\"sm\"></b-form-input></b-col>\n                                <b-col></b-col>\n                            </b-row>\n                            <b-row class=\"mt-3\">\n                                <b-col cols=\"1\"></b-col>\n                                <b-col><span>Tel&eacute;fono:</span></b-col><b-col cols=\"7\"><b-form-input class=\"ml-4\" placeholder=\"ej: 987654321\" type=\"text\" v-model=\"lector.tel_lec\" :state=\"null\" size=\"sm\"></b-form-input></b-col>\n                                <b-col></b-col>\n                            </b-row>\n                            <b-row class=\"mt-3\">\n                                <b-col cols=\"1\"></b-col>\n                                <b-col><span>Contrase&ntilde;a:</span></b-col><b-col cols=\"7\"><b-form-input class=\"ml-4\" type=\"password\" v-model=\"lector.contrasena_lec\" :state=\"null\" size=\"sm\"></b-form-input></b-col>\n                                <b-col></b-col>\n                            </b-row>\n                            <b-row class=\"mt-3\">\n                                <b-col cols=\"1\"></b-col>\n                                <b-col><span>Repita Contrase&ntilde;a:</span></b-col><b-col cols=\"7\"><b-form-input class=\"ml-4\" type=\"password\" v-model=\"confirmarclave\" :state=\"null\" size=\"sm\"></b-form-input></b-col>\n                                <b-col></b-col>\n                            </b-row>\n                        </b-container>\n                        <template #modal-footer>\n                            <div class=\"w-100\">\n                                <b-row>\n                                    <b-col align=\"right\">\n                                        <b-button variant='secondary' style=\"width: 4rem;\" size=\"sm\" @click=\"modalShow3 = !modalShow3, limpiarFormularioRegistro()\">Cerrar</b-button>\n                                        <b-button class=\"ml-3\" style=\"width: 8rem;\" variant='primary' size=\"sm\" @click=\"registrarLector()\">Registrar</b-button>\n                                    </b-col>                                        \n                                </b-row>                                    \n                            </div>                                                \n                        </template>\n                    </b-modal>\n                </template>\n            </div>\n            \n        </div>\n        <b-toast id=\"toast_Ok\" variant=\"success\" solid toaster=\"b-toaster-top-center\">\n            <template #toast-title>\n                <div class=\"d-flex flex-grow-1 align-items-baseline\">\n                <b-img blank blank-color=\"#5cb85c\" class=\"mr-2\" width=\"12\" height=\"12\"></b-img>\n                <strong class=\"mr-auto\">Información!</strong>                    \n                </div>\n            </template>\n            {{mensaje}}\n        </b-toast>\n\t\t<b-toast id=\"toast_Error\" variant=\"danger\" solid toaster=\"b-toaster-top-center\">\n            <template #toast-title>\n                <div class=\"d-flex flex-grow-1 align-items-baseline\">\n                <b-img blank blank-color=\"#d9534f\" class=\"mr-2\" width=\"12\" height=\"12\"></b-img>\n                <strong class=\"mr-auto\">Información!</strong>                    \n                </div>\n            </template>\n            {{mensaje}}\n        </b-toast>\n    </div>\n</b-container>\n\n</template>\n\n<script>\nimport axios from 'axios';\nimport moment from 'moment';\nimport auth from \"@/logica/auth\";\nimport emailjs from 'emailjs-com';\nimport{ init } from 'emailjs-com';\ninit(\"user_mA5SdDw3wIaNsBSflyelz\");\nexport default {\n    name: 'Catalogo',\n    data(){\n\n        const now = new Date()\n        const today = new Date(now.getFullYear(), now.getMonth(), now.getDate())\n        // Fecha de Hoy\n        const minDate = new Date(today)\n        minDate.setDate(today.getDate())\n        //minDate.setDate(15)\n\n        // 15 dias despues\n        const maxDate = new Date(today)\n        maxDate.setDate(minDate.getDate() + 15)\n        //maxDate.setDate(15)\n\n        return{\n            rut: '',\n            foto: '',\n            showBtnIniciar: true,\n            showBtnRegistrar: true,\n            btnSesion: false,\n\n            value: {},\n            min: minDate,\n            max: maxDate,\n            \n            item: '',\n            item1: '',\n            item2: null,\n            categoria: null,\n            tipoproducto: null,\n            selected: '',\n            texto1: '',\n            texto2: '',\n            cantidadProductosSala: 0,\n\n            btnAnadirLista:{\n                estado: {},\n                estadoFecha: {},\n                texto: {}\n            },\n\n\t\t\tmensaje: '',\n\n            confirmarclave: '',\n            modalShow1: false,\n            modalShow2: false,\n            modalShow3: false,\n            showDropdown: false,\n            select: null,\n            categorias: [],\n            xbusqueda: [],\n            xcategorias: [],\n            tipoproductos: [],\n            xtipoproductos: [],\n            lugar: [],\n            productos:[],            \n            tmp: [],\n            detalleProducto:[],\n            detalleReserva: [],\n            reservas: [],\n            prestamosSala: [],\n\n            idReservas: [],\n            maxIdReserva: [],\n\t\t\tidLectores: [],\n            maxIdLector: [],\n\n\n            lugarPrestamo:[                \n                {value:1,text:'Sala'},\n                {value:2,text:'Sala y Domicilio'}\n            ],\n            producto: {\n                id_producto: null,\n                desc_prod: '',\n                titulo: '',\n                autor: '',\n                editorial: '',\n                edicion: '',\n                anno_edic: null,\n                duracion: '',\n                tiempo_prest: null,\n                lugar_prest: null,\n                cantidad: null,\n                id_categoria: null,\n                id_ubicacion: null,\n                foto_producto: ''\n            },\n            lector: {\n                rut_lector: '',\n                nomb_lec: '',\n                ape_lec: '',\n                direccion: '',\n                correo_lec: '',\n                contrasena_lec:'',\n                tel_lec: '',\n\t\t\t\tactivo: 'I',\n\t\t\t\tfoto: '',\n\t\t\t\thuella: '',\n\t\t\t\tid_lector: null\n            }\n        }\n    },    \n    created(){\n        this.cargarProductos();\n\n\t\tif (auth.getUserLogged('user').rut_lector != '' || auth.getUserLogged('user').rut_lector != null) {\n            this.mostrarBotonLista();\n        } else {\n\t\t\tthis.ocultarBotonLista();\n\t\t}\n\n        //this.btnAnadirLista.texto = \"Añadir a la lista\"\n    },\n    methods:{\n        mostrarBotonIniciar(){\n\t\t\tthis.showBtnIniciar = true\n            this.showBtnRegistrar = true\n            this.btnSesion = false\n        },\n        ocultarBotonIniciar(){\n            this.showBtnIniciar = false\n            this.showBtnRegistrar = false\n            this.btnSesion = true\n        },\n        iniciar(){\n            this.ocultarBotonIniciar();\n            this.$router.push(\"/login\");\n        },\n        cerrarSesion(){\n            auth.deleteUserLogged('user');\n            this.rut = '';\n            this.contrasena = '';\n            this.foto = '';\n            this.$router.push(\"/login\");\n        },\n        filtroBuscarProducto(){    \n            let url;\n            url = \"http://localhost:3000/productos?lugar_prest=\"+this.item2\n            url += \"&titulo=\" + this.texto1\n            url += \"&autor=\" + this.texto2\n            url += \"&id_categoria=\" + this.categoria\n            axios.get(url).then(response => this.productos = response.data);\n        },\n        //Filtrar productos por Tipo  de Producto\n        cargarFiltroTipoProducto(){   \n                   \n            axios.get('http://localhost:3000/categorias?id_tipo_prod='+ this.tipoproducto).then(response => {\n                var datos= [];  \n                this.xtipoproductos = response.data\n                this.xtipoproductos.forEach(element => {\n                    axios.get('http://localhost:3000/productos?id_categoria='+ element.id_categoria).then(response => {\n                        this.xcategorias = response.data\n                        this.xcategorias.forEach(subelement => {                                       \n                            datos.push(subelement);\n                        });\n                    });\n                });\n                this.productos = datos;\n            });\n        },\n        //Filtrar productos por Categoria\n        cargarFiltroCategoria(){\n            axios.get('http://localhost:3000/productos?id_categoria='+ this.categoria).then(response => this.productos = response.data);\n        },\n        //Filtrar productos por Lugar de Préstamo\n        cargarFiltroLugar(){\n            axios.get('http://localhost:3000/productos?lugar_prest='+ this.item2).then(response => this.productos = response.data);\n        },\n        //Cargar todos los Productos\n        cargarProductos(){\n            axios.get('http://localhost:3000/productos').then(response => this.productos = response.data);\n        },\n        // Añadir Producto a la lista de deseos\n        anadirProducto(id,val){\n            //moment.locale();\n            var horaMinuto = moment().format('HH:mm');\n            var unirFechaHora = Date.parse( val+\" \"+horaMinuto);\n            var fechaCompleta = moment(unirFechaHora).format('YYYY-MM-DD HH:mm');\n            this.maxIdReserva = this.maxIdReserva + 1;\n\t\t\t\n\t\t\tif (val) {\n\t\t\t\ttry {                \n\t\t\t\t\tthis.tmp.push({rut_lector:JSON.parse(auth.getUserLogged('user')).rut_lector, fecha_reserva:fechaCompleta, id_producto:id, id_reserva:this.maxIdReserva});\n                    this.btnAnadirLista.estado[id] = true;\n                    this.btnAnadirLista.estadoFecha[id] = true;\n                    this.btnAnadirLista.texto[id] = true;\n\n\t\t\t\t\taxios.get('http://localhost:3000/productos/'+id)\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tthis.detalleReserva.push(response.data)                    \n\t\t\t\t\t});\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.log('ESTE ES EL ERROR:   ',error);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.mensaje = \"Para añadir a la lista debe seleccionar fecha de reserva.\";\n\t\t\t\tthis.$bvToast.show('toast_Error');\n\t\t\t}\n            /*\n            console.log(\"QUE ESTOY GUARDANDO EN LA LISTA DE DESEOS: FECHA RESERVA >> \", fechaCompleta);\n            console.log(\"FECHA Y HORA: \", fechaCompleta );\n            console.log(\"FECHA Y HORA: \", Date(fechaCompleta) );\n            */\n        },\n        // Buscar producto por el ID_PRODUCTO\n        buscarProducto(id){\n            this.cantidadProductosSala = 0;\n            axios.get('http://localhost:3000/productos/'+id)\n            .then(response => {\n                this.detalleProducto = response.data\n                \n                this.producto.id_producto=this.detalleProducto.id_producto\n                this.producto.desc_prod=this.detalleProducto.desc_prod\n                this.producto.titulo=this.detalleProducto.titulo\n                this.producto.autor=this.detalleProducto.autor\n                this.producto.editorial=this.detalleProducto.editorial\n                this.producto.edicion=this.detalleProducto.edicion\n                this.producto.anno_edic=this.detalleProducto.anno_edic\n                this.producto.duracion=this.detalleProducto.duracion\n                this.producto.tiempo_prest=this.detalleProducto.tiempo_prest\n                this.producto.lugar_prest=this.detalleProducto.lugar_prest\n                this.producto.cantidad=this.detalleProducto.cantidad\n                this.producto.id_categoria=this.detalleProducto.id_categoria\n                this.producto.id_ubicacion=this.detalleProducto.id_ubicacion\n                this.producto.foto_producto=this.detalleProducto.foto_producto\n                console.log(\"REVISANDO ID_PRODUCTO: \",this.producto.id_producto);\n\n                //http://localhost:3000/detalleprestamos?lugar=\n                axios.get('http://localhost:3000/detalleprestamos?lugar=Sala&id_producto='+this.producto.id_producto).then(response => {\n                    this.prestamosSala = response.data;\n                    this.cantidadProductosSala = this.prestamosSala.length;\n                });\n            });\n        },\n        //Eliminar producto de lista de deseos\n        quitarListaDeseo(id){            \n            this.detalleReserva = this.detalleReserva.filter( (r) => { return r.id_producto != id });\n            this.tmp = this.tmp.filter( (r) => { return r.id_producto != id });\n        },\n        //Guardar reserva\n        guardarReserva(){\n            if(this.tmp.length==0)\n            {\n                console.log('NO HAY PRODUCTOS PARA RESERVAR');\n            }\n            if(this.tmp.length>0)\n            {\n                this.tmp.forEach(element => {\n                    console.log('ELEMENT',element);                    \n                    axios.post('http://localhost:3000/reservas',{'reserva':element})\n                    .then(response => {\n                        if(response.status==201)\n                        {\n                            console.log('RESERVA GUARDADA EXITOSAMENTE');\n                            this.tmp= [];\n                            this.detalleReserva = [];\n                            this.modalShow2 = false;\n                            this.value= {};\n\n                            this.mensaje = \"Reserva ha sido registrada exitosamente en nuestro sistema.\";\n\t\t\t\t\t\t\tthis.$bvToast.show('toast_Ok');\n                        }\n                    })\n                    .catch(error => {\n\t\t\t\t\t\tthis.mensaje = \"Error al intentar guardar reserva.\";\n\t\t\t\t\t\tthis.$bvToast.show('toast_Error');\n            \n                        console.error(\"Este es el error desde guardar reserva: \",error);\n                    });\n                });\n            }\n        },\n        limpiarFormularioRegistro(){\n            // Limpiar campos formulario\n            this.lector.rut_lector = '';\n            this.lector.nomb_lec = '';\n            this.lector.ape_lec = '';\n            this.lector.direccion = '';\n            this.lector.correo_lec = '';\n            this.lector.contrasena_lec = '';\n            this.lector.tel_lec = '';\n            this.confirmarclave = '';\n        },\n        registrarLector(){\n\n\t\t\taxios.get('http://localhost:3000/lectores').then(response => {\n\t\t\t\tlet lec = []\n\t\t\t\tlec = response.data\n\t\t\t\tlec.forEach(element => {\n\t\t\t\t\tthis.idLectores.push(element.id_lector)\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif (this.idLectores.length == 0) {\n\t\t\t\t\tthis.maxIdLector = 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.maxIdLector = Math.max.apply(null, this.idLectores);\n\t\t\t\t}\n\n\t\t\t\tconst { validate, clean, format, getCheckDigit } = require('rut.js');\n\t\n\t\t\t\t//VERIFICA QUE EL RUT SEA VALIDO\n\t\t\t\tif (validate(this.lector.rut_lector)) {\n\t\t\t\t\t// VERIFICA QUE LA CUENTA NO EXISTA ANTES DE REGISTRAR\n\t\t\t\t\taxios.get(\"http://localhost:3000/lectores?rut_lector=\" + format(this.lector.rut_lector)).then(response => {\n\t\t\t\t\t\tlet dd=[];\n\t\t\t\t\t\tdd= response.data;\n\t\t\t\t\t\tconsole.log(dd);\n\t\t\t\t\t\t//SI LA CUENTA EXISTE ENTONCES MUESTRA LA ALERTA EN PANTALLA\n\t\t\t\t\t\tif (dd[0].rut_lector) {\n\t\t\t\t\t\t\tthis.mensaje = \"El Rut ingresado ya se encuentra registrado en nuestro sistema.\";\n\t\t\t\t\t\t\tthis.$bvToast.show('toast_Error');\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\tthis.lector.id_lector = this.maxIdLector+1;\n\n\t\t\t\t\t\t//DENTRO DEL CATCH SIGNIFICA QUE NO ENCONTRÓ EL RUT EN LA BB.DD, POR LO TANTO SE PUEDE REGISTRAR.\n\t\t\t\t\t\taxios.post('http://localhost:3000/lectores',{'lector':this.lector})\n\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\t//ENVIA LA NOTIFICACION DE LA CREACION DE LA CUENTA POR EMAIL\n\t\t\t\t\t\t\tthis.enviarEmailCuentaCreada();\n\t\t\t\t\t\t\tif(response.status==201)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconsole.log('LECTOR REGISTRADO EXITOSAMENTE');\n\t\t\t\t\t\t\t\tthis.modalShow3 = false;\n\t\t\t\t\t\t\t\t// Limpiar campos formulario\n\t\t\t\t\t\t\t\tthis.limpiarFormularioRegistro();\n\n\t\t\t\t\t\t\t\tthis.mensaje = \"Su cuenta se ha registrado exitosamente. Para activarla, revise su correo electrónico.\";\n\t\t\t\t\t\t\t\tthis.$bvToast.show('toast_Ok');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\tthis.mensaje = \"No se ha podido registrar su cuenta. Por favor revise los datos ingresados e intente nuevamente.\";\n\t\t\t\t\t\t\tthis.$bvToast.show('toast_Error');\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.mensaje = \"El Rut ingresado no es valido.\";\n\t\t\t\t\tthis.$bvToast.show('toast_Error');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t});\n        },\n        enviarEmailCuentaCreada(){\n\n            let data = {\n                from_name: \"Sistema Bibliotech\",\n                to_email: this.lector.correo_lec,\n                to_name: this.lector.nomb_lec,\n                message: \"Informamos que tu cuenta ha sido creada exitosamente. Para poder utilizar tu perfil en el sistema es necesario que actives tu cuenta. Para activarla debes hacer click en el siguiente enlace:\",\n                subject: \"Registro nueva cuenta en \",\n            };\n            \n            emailjs.send(\"service_33zw91m\",\"template_jyxqvrn\", data)\n            .then(response => {\n                if(response.text === 'OK'){\n\t\t\t\t\tthis.mensaje = \"El correo se ha enviado de forma exitosa.\";\n\t\t\t\t\tthis.$bvToast.show('toast_Ok');\n                }\n                console.log(\"SUCCESS. status=%d, text=%s\", response.status, response.text);\n            })\n            .catch(error => {\n\t\t\t\tthis.mensaje = \"Ocurrió un problema al enviar el correo.\";\n                this.$bvToast.show('toast_Error');\n                console.log(\"FAILED. error=\", err);\n            });\n        },\n        borrarFiltros(){\n            this.cargarProductos();\n            this.categoria = null;\n            this.tipoproducto = null;\n            this.item2= null;\n        },\n        mostrarBotonLista(){\n            this.showDropdown = true\n        },\n        ocultarBotonLista(){\n            this.showDropdown = false\n        }\n    },\n    computed:{\n        userLogged(){\n            return auth.getUserLogged('user');      \n        },\n\t\tformatearRutLector(){\n\t\t\tconst { validate, clean, format, getCheckDigit } = require('rut.js')\n\t\t\tthis.lector.rut_lector= format(this.lector.rut_lector);\n            if (format(this.lector.rut_lector).length > 10 && format(this.lector.rut_lector).length < 13) {\n                return true;\n            } else {\n                return false;\n            }\n        }\n    },\n    mounted : function(){\n\n        axios.get('http://localhost:3000/productos').then(response => {\n            this.productos = response.data\n        });\n\n        axios.get('http://localhost:3000/reservas').then(response => {\n            this.reservas = response.data\n            this.reservas.forEach(element => {\n                this.idReservas.push(element.id_reserva)\n            });\n            \n            if (this.idReservas.length == 0) {\n                this.maxIdReserva = 1;\n            } else {\n                this.maxIdReserva = Math.max.apply(null, this.idReservas);\n            }\n        });\n\n        this.rut = JSON.parse(auth.getUserLogged('user')).rut_lector;\n        this.foto = JSON.parse(auth.getUserLogged('user')).foto;\n\n        if (this.rut != '' || this.rut != null) {\n            this.ocultarBotonIniciar();\n        } else {\n\t\t\tthis.mostrarBotonIniciar();\n\t\t}\n        \n        axios.get('http://localhost:3000/categorias').then(response => this.categorias = response.data);\n        axios.get('http://localhost:3000/tipoproductos').then(response => this.tipoproductos = response.data);\n\t\t\n    }\n}\n</script>\n\n<style scoped>\n    b-img{\n        width:60px;\n        height:60px;\n    }\n    .bd-sidebar {\n        max-height: 30rem;\n        background-color: #17a2b8;\n        color: #f7f7f7;\n    }    \n</style>"]}]}