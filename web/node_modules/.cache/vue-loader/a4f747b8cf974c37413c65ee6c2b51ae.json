{"remainingRequest":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/src/views/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/src/views/Login.vue","mtime":1623876046675},{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/nicolas/Escritorio/Grupo 3_Proyecto Bibliotech/Sistema/Aplicación Web/Frontend/bibliotech/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KICAgIAovLyBpbXBvcnQgJ3Z1ZS10b2FzdC1ub3RpZmljYXRpb24vZGlzdC90aGVtZS1zdWdhci5jc3MnOwppbXBvcnQgYXV0aCBmcm9tICJAL2xvZ2ljYS9hdXRoIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ0xvZ2luJywKICAgIGNyZWF0ZWQoKXsgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICB9LAogICAgZGF0YSgpewogICAgICAgIHJldHVybnsKICAgICAgICAgICAgaXRlbUlkOiBudWxsLAogICAgICAgICAgICBtZW5zYWplOiAnJywKICAgICAgICAgICAgdGV4dG86ICcnLAogICAgICAgICAgICBydXRfbGVjdG9yOiAnJywKICAgICAgICAgICAgY29udHJhc2VuYV9sZWM6ICcnLAogICAgICAgICAgICBmb3RvOiAnJywKICAgICAgICAgICAgYWN0aXZvOiAnJywKICAgICAgICAgICAgZXJyb3I6IGZhbHNlLAogICAgICAgICAgICBkYXRvczogW10KICAgICAgICB9CiAgICB9LAogICAgbWV0aG9kczp7CiAgICAgICAgaW5pY2lhclNlc2lvbigpewogICAgICAgICAgICBjb25zdCB7IHZhbGlkYXRlLCBjbGVhbiwgZm9ybWF0LCBnZXRDaGVja0RpZ2l0IH0gPSByZXF1aXJlKCdydXQuanMnKQogICAgICAgICAgICB0cnkgewoKICAgICAgICAgICAgICAgIGF4aW9zLmdldCgiaHR0cDovL2xvY2FsaG9zdDozMDAwL2xlY3RvcmVzP3J1dF9sZWN0b3I9IiArIGZvcm1hdCh0aGlzLnJ1dF9sZWN0b3IpKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdG9zID0gcmVzcG9uc2UuZGF0YQogICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ1FVRSBUSUVORSBMRUNUT1JFUzogJyx0aGlzLmRhdG9zKTsKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdRVUUgVElFTkUgTEVDVE9SRVMgcnV0OiAnLGZvcm1hdCh0aGlzLmRhdG9zWzBdLnJ1dF9sZWN0b3IpKTsKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdRVUUgVElFTkUgTEVDVE9SRVMgY29udHJhc2VuYTogJyx0aGlzLmRhdG9zWzBdLmNvbnRyYXNlbmFfbGVjKTsKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdRVUUgVElFTkUgTEVDVE9SRVMgdXJsIGZvdG86ICcsdGhpcy5kYXRvc1swXS5mb3RvKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjb25zdCB1c2VyID0gewogICAgICAgICAgICAgICAgICAgICAgICBydXRfbGVjdG9yOiBmb3JtYXQodGhpcy5ydXRfbGVjdG9yKSwKICAgICAgICAgICAgICAgICAgICAgICAgY29udHJhc2VuYV9sZWM6IHRoaXMuY29udHJhc2VuYV9sZWMsCiAgICAgICAgICAgICAgICAgICAgICAgIGZvdG86dGhpcy5kYXRvc1swXS5mb3RvLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdm86dGhpcy5kYXRvc1swXS5hY3Rpdm8KICAgICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGUodGhpcy5ydXRfbGVjdG9yKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGZvcm1hdCh0aGlzLnJ1dF9sZWN0b3IpID09IHRoaXMuZGF0b3NbMF0ucnV0X2xlY3RvcikgJiYgKHRoaXMuY29udHJhc2VuYV9sZWMgPT0gdGhpcy5kYXRvc1swXS5jb250cmFzZW5hX2xlYykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodGhpcy5kYXRvc1swXS5hY3Rpdm8gPT0gJ0EnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGguc2V0VXNlckxvZ2dlZCh1c2VyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiLyIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnNhamUgPSAiQWNjZXNvIERlbmVnYWRvLiBUdSBwZXJmaWwgc2UgZW5jdWVudHJhIGluaGFiaWxpdGFkby4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3Quc2hvdygndG9hc3RfZXJyb3InKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVuc2FqZSA9ICJIYXMgaW50cm9kdWNpZG8gbWFsIGVsIFJ1dCBvIGxhIENvbnRyYXNlw7FhLiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3Quc2hvdygndG9hc3RfZXJyb3InKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnNhamUgPSAiSGFzIGludHJvZHVjaWRvIG1hbCBlbCBSdXQgbyBsYSBDb250cmFzZcOxYS4iOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kYnZUb2FzdC5zaG93KCd0b2FzdF9lcnJvcicpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnNhamUgPSAiSGFzIGludHJvZHVjaWRvIG1hbCBlbCBSdXQgbyBsYSBDb250cmFzZcOxYS4iOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3Quc2hvdygndG9hc3RfZXJyb3InKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICAgICAgdGhpcy5tZW5zYWplID0gIkZhbGzDsyBlbCBpbmdyZXNvLiBQb3IgZmF2b3IgcmV2aXNlIGxvcyBkYXRvcyBpbmdyZXNhZG9zIGUgaW50ZW50ZSBudWV2YW1lbnRlLiI7CiAgICAgICAgICAgICAgICB0aGlzLmVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3Quc2hvdygndG9hc3RfZXJyb3InKQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB2b2x2ZXJDYXRhbG9nbygpewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiLyIpOwogICAgICAgIH0KICAgIH0sCiAgICBjb21wdXRlZDp7CiAgICAgICAgY29tcHJvYmFyVXNlcm5hbWUoKXsKICAgICAgICAgICAgcmV0dXJuIHRoaXMucnV0X2xlY3Rvci5sZW5ndGggPiAwID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgIH0sCiAgICAgICAgY29tcHJvYmFyUGFzc3dvcmQoKXsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udHJhc2VuYV9sZWMubGVuZ3RoID4gMCA/IHRydWUgOiBmYWxzZTsKICAgICAgICB9CiAgICB9LAogICAgbW91bnRlZDpmdW5jdGlvbigpewoKICAgIH0gICAgICAgICAgICAgICAgIAp9Cg=="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoFA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n      <b-container fluid=\"1\" >\n            <b-row class=\"mt-5\">\n                <b-col cols=\"2\"></b-col>\n                <b-col cols=\"8\" align=\"center\">\n                    <b-card img-top style=\"width: rem;\" bg-variant=\"light\">                        \n\n                        <form action class=\"form\" @submit.prevent=\"iniciarSesion\">  \n                            <b-row class=\"mt-2\">\n                                <b-col></b-col>\n                                <b-col cols=\"3\">\n                                    <div><b-img src=\"http://poseidon.conpax.cl/~nicolas/Logo_Bibliotech.png\" class=\"d-inline-block align-top\" fluid alt=\"responsive image\"></b-img></div>\n                                </b-col>\n                                <b-col></b-col>\n                            </b-row>\n\n                            <b-row>\n                                <b-col></b-col>   \n                                <b-col align=\"center\" cols=\"8\">\n                                    <h5 class=\"mt-2\" align=\"center\">Sistema de Préstamos y Devoluciones Bibliotech</h5>\n                                </b-col>\n                                <b-col></b-col>   \n                            </b-row>\n                            \n                            <b-row class=\"mt-3\">\n                                <b-col>\n                                    <h5 class=\"mt-0\" align=\"center\" ><strong>Inicio de Sesión</strong></h5>\n                                </b-col>\n                            </b-row>\n                            \n                            <b-row class=\"mt-2\">    \n                                <b-col></b-col>          \n                                <b-col cols=\"8\">                  \n                                    <b-form-input type=\"text\" id=\"username\" name=\"username\" label=\"username\"\n                                    v-model=\"rut_lector\" placeholder=\"ej: 12.345.678-9\" class=\"form-control\"\n                                    :state=\"comprobarUsername\" :bordered=true autofocus></b-form-input>\n                                        <b-form-invalid-feedback id=\"input-live-feedback\">Este campo es requerido</b-form-invalid-feedback>\n                                </b-col>  \n                                <b-col></b-col>                            \n                            </b-row>\n\n                            <b-row class=\"mt-2\">\n                                <b-col></b-col> \n                                <b-col cols=\"8\">                  \n                                    <b-form-input type=\"password\" id=\"contrasena\" name=\"contrasena\" label=\"contrasena\" align=\"center\"\n                                    v-model=\"contrasena_lec\" placeholder=\"Contraseña\" class=\"form-control\"\n                                    :state=\"comprobarPassword\" :bordered=true></b-form-input>\n                                        <b-form-invalid-feedback id=\"input-live-feedback\">Este campo es requerido</b-form-invalid-feedback>\n                                </b-col>                                    \n                                <b-col></b-col> \n                            </b-row>\n\n                            <b-row class=\"mt-3\">  \n                                <b-col></b-col>\n                                <b-col cols=\"6\" align=\"center\"><b-button block variant=\"info\"  @click=\"iniciarSesion()\" >Iniciar Sesión</b-button></b-col>                  \n                                <b-col></b-col>                          \n                            </b-row>\n\n                            <b-row class=\"mt-3\">  \n                                <b-col></b-col>\n                                <b-col cols=\"4\" align=\"center\"><b-button outlined variant=\"outline-info\"  @click=\"volverCatalogo()\" >Volver al Catálogo</b-button></b-col>                  \n                                <b-col></b-col>                          \n                            </b-row>\n\n                            <b-row class=\"mt-3\">\n                                <b-col align=\"center\">\n                                    <b-toast id=\"toast_error\" variant=\"danger\" solid title=\"¡Atención.!\" static >\n                                        {{mensaje}}\n                                    </b-toast>\n                                </b-col>\n                            </b-row>                                                   \n                        </form>\n                    </b-card>\n                </b-col>\n                <b-col cols=\"2\"></b-col>\n            </b-row>\n            <b-row class=\"mt-2\" ></b-row>\n        </b-container>\n    </div>\n</template>\n\n\n<script>    \n// import 'vue-toast-notification/dist/theme-sugar.css';\nimport auth from \"@/logica/auth\";\nimport axios from \"axios\";\nexport default {\n    name: 'Login',\n    created(){            \n                        \n    },\n    data(){\n        return{\n            itemId: null,\n            mensaje: '',\n            texto: '',\n            rut_lector: '',\n            contrasena_lec: '',\n            foto: '',\n            activo: '',\n            error: false,\n            datos: []\n        }\n    },\n    methods:{\n        iniciarSesion(){\n            const { validate, clean, format, getCheckDigit } = require('rut.js')\n            try {\n\n                axios.get(\"http://localhost:3000/lectores?rut_lector=\" + format(this.rut_lector)).then(response => {\n                    this.datos = response.data\n                    //console.log('QUE TIENE LECTORES: ',this.datos);\n                    //console.log('QUE TIENE LECTORES rut: ',format(this.datos[0].rut_lector));\n                    //console.log('QUE TIENE LECTORES contrasena: ',this.datos[0].contrasena_lec);\n                    //console.log('QUE TIENE LECTORES url foto: ',this.datos[0].foto);\n                    \n                    const user = {\n                        rut_lector: format(this.rut_lector),\n                        contrasena_lec: this.contrasena_lec,\n                        foto:this.datos[0].foto,\n                        activo:this.datos[0].activo\n                    };\n\n                    if (validate(this.rut_lector)) {\n                        if ((format(this.rut_lector) == this.datos[0].rut_lector) && (this.contrasena_lec == this.datos[0].contrasena_lec)) {\n                            if ((this.datos[0].activo == 'A')) {\n                                auth.setUserLogged(user);\n                                this.$router.push(\"/\");\n                            } else {\n                                this.mensaje = \"Acceso Denegado. Tu perfil se encuentra inhabilitado.\";\n                                this.error = true;\n                                this.$bvToast.show('toast_error');\n                            }\n                        } else {\n                            this.mensaje = \"Has introducido mal el Rut o la Contraseña.\";\n                            this.error = true;\n                            this.$bvToast.show('toast_error');\n                        }\n\n                    } else {\n                        this.mensaje = \"Has introducido mal el Rut o la Contraseña.\";\n                        this.error = true;\n                        this.$bvToast.show('toast_error');\n                    }\n\n                })\n                .catch(error => {\n                    this.mensaje = \"Has introducido mal el Rut o la Contraseña.\";\n                    this.error = true;\n                    this.$bvToast.show('toast_error');\n                });\n            } catch (error) {\n                console.log(error);\n                this.mensaje = \"Falló el ingreso. Por favor revise los datos ingresados e intente nuevamente.\";\n                this.error = true;\n                this.$bvToast.show('toast_error')\n            }\n        },\n        volverCatalogo(){\n            this.$router.push(\"/\");\n        }\n    },\n    computed:{\n        comprobarUsername(){\n            return this.rut_lector.length > 0 ? true : false;\n        },\n        comprobarPassword(){\n            return this.contrasena_lec.length > 0 ? true : false;\n        }\n    },\n    mounted:function(){\n\n    }                 \n}\n</script>"]}]}